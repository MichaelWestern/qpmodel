select
	l_orderkey,
	sum(l_extendedprice * (1 - l_discount)) as revenue,
	o_orderdate,
	o_shippriority
from
	customer,
	orders,
	lineitem
where
	c_mktsegment = 'BUILDING'
	and c_custkey = o_custkey
	and l_orderkey = o_orderkey
	and o_orderdate < date '1995-03-15'
	and l_shipdate > date '1995-03-15'
group by
	l_orderkey,
	o_orderdate,
	o_shippriority
order by
	revenue desc,
	o_orderdate
limit 10
Total cost: 16724.13
PhysicLimit (10) (inccost=16724.13, cost=10, rows=10) (actual rows=8)
    Output: lineitem.l_orderkey[0],{sum(lineitem.l_extendedprice*1-lineitem.l_discount)}[1],orders.o_orderdate[2],orders.o_shippriority[3]
    -> PhysicOrder  (inccost=16714.13, cost=2859.13, rows=459) (actual rows=8)
        Output: lineitem.l_orderkey[0],{sum(lineitem.l_extendedprice*1-lineitem.l_discount)}[1],orders.o_orderdate[2],orders.o_shippriority[3]
        Order by: {sum(lineitem.l_extendedprice*1-lineitem.l_discount)}[1], orders.o_orderdate[2]
        -> PhysicHashAgg  (inccost=13855, cost=1377, rows=459) (actual rows=8)
            Output: {lineitem.l_orderkey}[0],{sum(lineitem.l_extendedprice*1-lineitem.l_discount)}[3],{orders.o_orderdate}[1],{orders.o_shippriority}[2]
            Aggregates: sum(lineitem.l_extendedprice[4]*1-lineitem.l_discount[7])
            Group by: lineitem.l_orderkey[0], orders.o_orderdate[1], orders.o_shippriority[2]
            -> PhysicHashJoin  (inccost=12478, cost=2101, rows=459) (actual rows=14)
                Output: lineitem.l_orderkey[2],orders.o_orderdate[3],orders.o_shippriority[4],{lineitem.l_extendedprice*1-lineitem.l_discount}[5],lineitem.l_extendedprice[6],{1-lineitem.l_discount}[7],{1}[0],lineitem.l_discount[8]
                Filter: customer.c_custkey[1]=orders.o_custkey[9]
                -> PhysicScanTable customer (inccost=29, cost=29, rows=29) (actual rows=29)
                    Output: 1,customer.c_custkey[0]
                    Filter: customer.c_mktsegment[6]='BUILDING'
                -> PhysicHashJoin  (inccost=10348, cost=6326, rows=1584) (actual rows=133)
                    Output: lineitem.l_orderkey[4],orders.o_orderdate[0],orders.o_shippriority[1],{lineitem.l_extendedprice*1-lineitem.l_discount}[5],lineitem.l_extendedprice[6],{1-lineitem.l_discount}[7],lineitem.l_discount[8],orders.o_custkey[2]
                    Filter: lineitem.l_orderkey[4]=orders.o_orderkey[3]
                    -> PhysicScanTable orders (inccost=720, cost=720, rows=720) (actual rows=726)
                        Output: orders.o_orderdate[4],orders.o_shippriority[7],orders.o_custkey[1],orders.o_orderkey[0]
                        Filter: orders.o_orderdate[4]<'1995-03-15'
                    -> PhysicScanTable lineitem (inccost=3302, cost=3302, rows=3302) (actual rows=3252)
                        Output: lineitem.l_orderkey[0],lineitem.l_extendedprice[5]*1-lineitem.l_discount[6],lineitem.l_extendedprice[5],1-lineitem.l_discount[6],lineitem.l_discount[6]
                        Filter: lineitem.l_shipdate[10]>'1995-03-15'
1637,164224.9253,2/8/1995 12:00:00 AM,0
5191,49378.3094,12/11/1994 12:00:00 AM,0
742,43728.048,12/23/1994 12:00:00 AM,0
3492,43716.0724,11/24/1994 12:00:00 AM,0
2883,36666.9612,1/23/1995 12:00:00 AM,0
998,11785.5486,11/26/1994 12:00:00 AM,0
3430,4726.6775,12/12/1994 12:00:00 AM,0
4423,3055.9365,2/17/1995 12:00:00 AM,0

